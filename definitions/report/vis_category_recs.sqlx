config {
  type: 'view'
}

with r as (
  select
    sum(relevant_impressions / 365) as relevant_impressions_daily,
    ${channel.recCatColumns()}
  from
    ${ref('channel_recs_monthly')}
    where rec_month between '2019-01-01'::date and last_day('2019-01-01'::date, year)
    group by ${channel.recCatColumns()}
)
select * from r
